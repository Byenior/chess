<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="field">
      <table id="table-body" border="1"></table>
    </div>

    <div id="chat" onclick="moveChat()">
      <h1>Chat</h1>
    </div>

    <div id="roomChat" style="right: 2%; left: auto; top: 2%">
      <ul id="messages"></ul>
      <form id="form" action="">
        <input id="input" class="typeMassage" autocomplete="off" /><button>
          Send
        </button>
      </form>
    </div>
  </body>
</html>
<script>
  // create field
  let scale = 16;
  const tableBody = document.getElementById("table-body");
  // Create scale rows
  for (let i = 0; i < scale; i++) {
    const row = document.createElement("tr");
    // Create scale cells in the row
    for (let j = 0; j < scale; j++) {
      const cell = document.createElement("td");
      cell.id = i * scale + j + 1;
      row.appendChild(cell);
    }
    tableBody.appendChild(row);
  }
</script>
<script
  src="https://cdn.socket.io/4.7.4/socket.io.min.js"
  integrity="sha384-Gr6Lu2Ajx28mzwyVR8CFkULdCU7kMlZ9UthllibdOSo6qAiN+yXNHqtgdTvFXMT4"
  crossorigin="anonymous"
></script>
<script>
  const form = document.getElementById("form");
  const input = document.getElementById("input");
  const messages = document.getElementById("messages");

  const link = "http://localhost:7777/";
  const socket = io(link);

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    if (input.value) {
      console.log("from input : ", input.value);
      socket.emit("message", input.value);
      input.value = "";
    }
  });

  socket.on("connect", () => {
    console.log("Connected to server");
  });

  socket.on("disconnect", () => {
    console.log("Disconnected from server");
  });

  socket.on("message", (data) => {
    console.log("data from socket: ", data);
    const item = document.createElement("li");
    item.classList = "curved-arrow";

    let div = document.createElement("div");
    div.classList = "chatFrame";

    let div_top = document.createElement("div");
    div_top.style.display = "flex";
    let div_bot = document.createElement("div");

    let name = document.createElement("p");
    name.innerHTML = data.name;
    let message = document.createElement("p");
    message.innerHTML = data.message;
    let date = document.createElement("p");
    date.innerHTML = data.date;

    div_top.appendChild(name);
    div_top.appendChild(date);

    div_bot.appendChild(message);

    div.appendChild(div_top);
    div.appendChild(div_bot);

    // item.textContent = div;
    item.appendChild(div);

    messages.appendChild(item);
  });
</script>
<script src="myMine.js"></script>
<script>
  // chat
  function moveChat() {
    let roomChat = document.getElementById("roomChat");

    if (roomChat.style.right != "2%") {
      roomChat.style.right = "2%";
      roomChat.style.left = "auto";
      roomChat.style.top = "2%";
    } else {
      roomChat.style.right = "-100%";
      roomChat.style.left = "auto";
      roomChat.style.top = "2%";
    }
  }

  var draggable = document.getElementById("messages");
  var divMove = document.getElementById("roomChat");

  var posX = 0,
    posY = 0,
    mouseX = 0,
    mouseY = 0;

  draggable.addEventListener("mousedown", mouseDown, false);
  window.addEventListener("mouseup", mouseUp, false);

  function mouseDown(e) {
    e.preventDefault();
    posX = e.clientX - divMove.offsetLeft;
    posY = e.clientY - divMove.offsetTop;
    window.addEventListener("mousemove", moveElement, false);
  }

  function mouseUp() {
    window.removeEventListener("mousemove", moveElement, false);
  }

  function moveElement(e) {
    mouseX = e.clientX - posX;
    mouseY = e.clientY - posY;
    divMove.style.left = mouseX + "px";
    divMove.style.top = mouseY + "px";
  }
</script>
<!-- <script src="https://apis.google.com/js/api.js"></script> -->

<!-- <script type="module" src="data.js"></script>
<script>
  // init();
</script> -->
